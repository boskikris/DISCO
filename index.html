<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="y_key" content="dc1e5c3ab827572c">
    <meta name="msvalidate.01" content="B3AA1BC2E84591E6D01C7D543018E8A7">
    <meta name="google-site-verification" content="H6kzC1E15oZeyHfCaHwSaPyCyeRjCuwm6rO7v0pjRyo">
    <meta name="theme-color" content="red" class="browser-color">
    <meta name="msapplication-navbutton-color" content="#000" class="browser-color">
    <meta name="apple-mobile-web-app-status-bar-style" content="#000" class="browser-color">
    <meta name="robots" content="index, follow">
    <title>Disco--------------------------</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link type="image/x-icon" rel="shortcut icon" href="favico.ico" id="favicon">
      <style media="screen">
        html, body{
          height: 100%;
        }

        body {
          font-family: "Comic Sans MS", sans-serif;
          color: green;
          background: red;
          font-size: 40vmin;
          overflow: hidden;
          text-align: center;
          cursor: wait;
        }
        .text {
          -webkit-user-select: none; /* Chrome/Safari */
          -moz-user-select: none; /* Firefox */
          -ms-user-select: none; /* IE10+ */

          -o-user-select: none;
          user-select: none;
        }
      </style>
      <script language="javascript" type="text/javascript">
        var phrase = window.location.pathname.substr(1) || "Disco";
        phrase = decodeURIComponent(phrase);
        var t;
        var color = ["blue","yellow","lime","magenta","aqua","green","orange","crimson","royalblue","hotpink","indigo","dodgerblue","chartreuse","skyblue","red"];
        var bg = 0;
        var fg = 1;
        document.title = phrase + "-".repeat(Math.max(1, 31-phrase.length));

        var cursors = ["wait", "pointer", "help", "copy", "zoom-in", "zoom-out", "move"];
        var c = 0;

        var canvas = document.createElement('canvas');
        canvas.width = 16;canvas.height = 16;
        var ctx = canvas.getContext('2d');

        var audio;

        window.addEventListener("load", function () {
          tick();

          document.querySelector(".text-top").innerText = phrase;
          document.querySelector(".text-bottom").innerText = phrase;

          let ts = document.addEventListener("touchstart", function () {
            // Make music playable on some mobile devices
            audio = document.querySelector("audio").play();
            document.removeEventListener("touchstart", ts, false);
          }, false);

          audioSetup();
        }, false);


        var tick = function () {
          document.body.style.backgroundColor = color[bg];
          document.body.style.color = color[fg];
          document.body.style.cursor = cursors[c];

          if (++bg >= color.length) {
            bg = 0;
          }

          if(++fg >= color.length){
            fg = 0;
          }

          if(++c >= cursors.length){
            c = 0;
          }

          generateFavicon();

          var browsers = document.querySelectorAll(".browser-color");
          for (var k = 0; k < browsers.length; k++) {
            browsers[k].setAttribute("content", window.getComputedStyle(document.body).backgroundColor);
          }

          let fs = Math.round(Math.random()*30);
          document.querySelector(".text-top").style.fontSize = fs+10+"vmin";
          document.querySelector(".text-bottom").style.fontSize = 40-fs+"vmin";

          document.title = document.title.substr(1) + document.title.substr(0,1);

          // Add vibrations on some devices?
          window.navigator.vibrate(fs);

          t = setTimeout(tick, 50);
        }

        var invertedText = false;
        function audioSetup(){
          var audio_file = new Audio('/assets/disco.mp3');
          audio_file.addEventListener('timeupdate', function(){
            var buffer = .44;
            if(this.currentTime > this.duration - buffer){
              this.currentTime = 0;
              this.play();

              invertedText = !invertedText;
              if(invertedText){
                document.querySelector("body").style.transform = "scaleY(-1)";
              }
              else{
                document.querySelector("body").style.transform = "scaleY(1)";
              }
            }
          }, false);
          audio_file.play();
        }

        function generateFavicon() {
          ctx.fillStyle = window.getComputedStyle(document.body).backgroundColor;
          ctx.fillRect(0, 0, 16, 16);

          document.getElementById("favicon").setAttribute("href", canvas.toDataURL("image/x-icon"));
        }
      </script>
  </head>
  <body>
    <div class="text text-top">Disco</div><div class="text text-bottom">Disco</div>
    <!--
        Disco is made by Gustav BlomÃ©r (http://gkj.se) and Johan Lindell (http://lindell.me).
        The webpage is released under Creative Commons BY-NC-SA, the music is NOT released under the same license and you are not allowed to copy it!

        This work is licensed under the Creative Commons Attribution-Noncommercial-Share Alike 2.5 Sweden License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/2.5/se/ or send a letter to Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
    -->

    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-7045832-5', 'auto');
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
  </body>
</html>
